<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>Phomymo - Free Label Designer for Phomemo Thermal Printers</title>

  <!-- SEO Meta Tags -->
  <meta name="description" content="Free browser-based label designer for Phomemo thermal printers. Create custom labels with text, barcodes, QR codes, and images. No drivers needed - connects via Bluetooth. Works with M02, M03, M110, M120, M200, M220, M260, D30, D35, D50, Q30 and more.">
  <meta name="keywords" content="Phomemo, label printer, thermal printer, label designer, barcode generator, QR code, P12, P12 Pro, M02, M02S, M02X, M02 Pro, M03, M04S, M110, M110S, M120, M200, M220, M250, M260, D30, D35, D50, Q30, Q30S, T02, bluetooth printer, label maker, free label software, Phomemo alternative, thermal label printer software">
  <meta name="author" content="Phomymo">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://phomymo.affordablemagic.net/">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://phomymo.affordablemagic.net/">
  <meta property="og:title" content="Phomymo - Free Label Designer for Phomemo Thermal Printers">
  <meta property="og:description" content="Free browser-based label designer for Phomemo printers. Create labels with text, barcodes, QR codes. No drivers - connects via Bluetooth.">
  <meta property="og:site_name" content="Phomymo">
  <meta property="og:image" content="https://phomymo.affordablemagic.net/screenshot.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://phomymo.affordablemagic.net/">
  <meta name="twitter:title" content="Phomymo - Free Label Designer for Phomemo Thermal Printers">
  <meta name="twitter:description" content="Free browser-based label designer for Phomemo printers. Create labels with text, barcodes, QR codes. No drivers - connects via Bluetooth.">
  <meta name="twitter:image" content="https://phomymo.affordablemagic.net/screenshot.png">

  <!-- Additional SEO -->
  <meta name="application-name" content="Phomymo Label Designer">
  <meta name="theme-color" content="#3b82f6">

  <!-- Structured Data for Rich Snippets -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Phomymo Label Designer",
    "url": "https://phomymo.affordablemagic.net/",
    "description": "Free browser-based label designer for Phomemo thermal printers. Create custom labels with text, barcodes, QR codes, and images.",
    "applicationCategory": "DesignApplication",
    "operatingSystem": "Any (Web Browser)",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "featureList": [
      "Text labels with multiple fonts",
      "Barcode generation (Code128, EAN-13, UPC-A, Code39)",
      "QR code generation",
      "Image import",
      "Shape tools",
      "Bluetooth connectivity",
      "No drivers required"
    ],
    "screenshot": "https://phomymo.affordablemagic.net/screenshot.png",
    "softwareHelp": "https://github.com/transcriptionstream/phomymo"
  }
  </script>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto:wght@400;500;700&family=Open+Sans:wght@400;600;700&family=Lato:wght@400;700&family=Montserrat:wght@400;500;600;700&family=Oswald:wght@400;500;600&family=Playfair+Display:wght@400;500;600;700&family=Merriweather:wght@400;700&family=Roboto+Mono:wght@400;500;700&family=Source+Code+Pro:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    /* Hide body until styles are ready to prevent FOUC */
    body { opacity: 0; font-family: 'Inter', system-ui, sans-serif; }
    body.ready { opacity: 1; transition: opacity 0.1s ease-in; }
    .canvas-bg {
      background-image: linear-gradient(45deg, #e5e7eb 25%, transparent 25%),
                        linear-gradient(-45deg, #e5e7eb 25%, transparent 25%),
                        linear-gradient(45deg, transparent 75%, #e5e7eb 75%),
                        linear-gradient(-45deg, transparent 75%, #e5e7eb 75%);
      background-size: 12px 12px;
      background-position: 0 0, 0 6px, 6px -6px, -6px 0px;
    }
    .toolbar-btn {
      @apply px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm font-medium rounded-lg border border-gray-200 bg-white flex items-center gap-1 sm:gap-1.5 whitespace-nowrap;
      transition: all 0.15s ease;
    }
    .toolbar-btn:hover {
      background-color: #f3f4f6;
      border-color: #d1d5db;
    }
    .toolbar-btn:active {
      background-color: #e5e7eb;
      transform: scale(0.96);
    }
    .toolbar-btn:disabled {
      @apply opacity-50 cursor-not-allowed;
    }
    .toolbar-btn:disabled:hover {
      background-color: white;
      border-color: #e5e7eb;
    }
    button.toolbar-btn.toolbar-btn-menu {
      border-style: dashed;
      border-width: 1px;
    }
    .toolbar-divider {
      @apply w-px h-5 sm:h-6 bg-gray-200 mx-1 sm:mx-2 flex-shrink-0;
    }
    /* Hide toolbar button text on small screens */
    @media (max-width: 640px) {
      .toolbar-btn-text { display: none; }
    }
    /* Properties panel open state */
    #props-panel.panel-open {
      transform: translateX(0);
    }
    /* Mobile backdrop for properties panel */
    #props-backdrop {
      @apply fixed inset-0 bg-black/50 z-40 hidden;
    }
    #props-backdrop.backdrop-visible {
      @apply block md:hidden;
    }
    .prop-label {
      font-size: 0.75rem;
      line-height: 1rem;
      color: #6b7280;
      font-weight: 600;
      margin-bottom: 0.25rem;
    }
    .prop-input {
      width: 100%;
      padding: 0.375rem 0.5rem;
      font-size: 0.875rem;
      line-height: 1.25rem;
      border: 1px solid #e5e7eb;
      border-radius: 0.25rem;
      box-sizing: border-box;
    }
    .prop-input:focus {
      outline: none;
      box-shadow: 0 0 0 2px #60a5fa;
      border-color: transparent;
    }
    /* Mobile-specific input styling - more obvious editable appearance */
    @media (max-width: 767px) {
      .prop-input {
        border-color: #d1d5db;
        background-color: #f9fafb;
        padding-top: 0.625rem;
        padding-bottom: 0.625rem;
        font-size: 1rem;
        line-height: 1.5rem;
        -webkit-appearance: none;
      }
      .prop-input:focus {
        background-color: white;
      }
      select.prop-input {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
        background-position: right 0.5rem center;
        background-repeat: no-repeat;
        background-size: 1.5em 1.5em;
        padding-right: 2.5rem;
      }
      textarea.prop-input {
        min-height: 60px;
      }
    }
    .prop-row {
      display: flex;
      gap: 0.5rem;
    }
    .prop-group {
      margin-bottom: 1rem;
    }

    /* Mobile UI styles */
    @media (max-width: 767px) {
      .desktop-only { display: none !important; }
      .mobile-only { display: flex !important; }
      .mobile-only.mobile-hidden { display: none !important; }
      /* Add space for fixed header and toolbar */
      body { padding-top: 52px; padding-bottom: 160px; }
      /* Move zoom controls to top on mobile */
      #zoom-controls {
        bottom: auto !important;
        top: 60px;
      }
      /* Make footer fixed above the toolbar on mobile */
      footer {
        position: fixed !important;
        bottom: calc(130px + env(safe-area-inset-bottom, 0px));
        left: 0;
        right: 0;
        z-index: 45;
      }
      /* Ensure print settings dialog is fully visible above toolbar */
      #print-settings-dialog {
        padding-bottom: calc(140px + env(safe-area-inset-bottom, 0px));
        align-items: flex-start;
        padding-top: 60px;
      }
      #print-settings-dialog > div {
        max-height: calc(100vh - 200px - env(safe-area-inset-bottom, 0px));
      }
    }
    @media (min-width: 768px) {
      .mobile-only { display: none !important; }
    }

    /* Mobile fixed bottom toolbar */
    .mobile-toolbar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: white;
      border-top: 1px solid #e5e7eb;
      z-index: 50;
      padding-bottom: env(safe-area-inset-bottom, 0);
    }

    .mobile-toolbar-row {
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: 8px 4px;
    }

    .mobile-tool-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 6px 10px;
      border-radius: 8px;
      font-size: 9px;
      color: #6b7280;
      background: transparent;
      border: none;
      cursor: pointer;
      min-width: 52px;
    }

    .mobile-tool-btn:active {
      background: #f3f4f6;
    }

    .mobile-tool-btn svg {
      width: 22px;
      height: 22px;
      margin-bottom: 2px;
    }

    .mobile-tool-btn.danger {
      color: #ef4444;
    }

    .mobile-divider {
      width: 1px;
      height: 32px;
      background: #e5e7eb;
    }

    /* Mobile properties panel */
    .mobile-props-panel {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: white;
      border-radius: 16px 16px 0 0;
      box-shadow: 0 -4px 20px rgba(0,0,0,0.15);
      z-index: 55;
      max-height: 60vh;
      transform: translateY(100%);
      transition: transform 0.3s ease-out;
      padding-bottom: env(safe-area-inset-bottom, 0);
    }

    .mobile-props-panel.props-open {
      transform: translateY(0);
    }

    .mobile-props-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 16px;
      border-bottom: 1px solid #e5e7eb;
      width: 100%;
    }

    .mobile-props-content {
      padding: 16px;
      overflow-y: auto;
      max-height: calc(60vh - 100px);
      width: 100%;
    }

    /* Mobile menu */
    #mobile-menu-panel {
      transition: transform 0.3s ease-out;
    }
    #mobile-menu-panel.menu-open {
      transform: translateX(0) !important;
    }
  </style>
</head>
<body class="bg-gray-100 h-screen flex flex-col overflow-hidden">

  <!-- Mobile Top Bar -->
  <header id="mobile-header" class="mobile-only fixed top-0 left-0 right-0 bg-white border-b border-gray-200 px-3 py-2 z-40">
    <div class="flex items-center w-full">
      <!-- Hamburger Menu Button -->
      <button id="mobile-menu-btn" class="p-2 -ml-2 rounded-lg hover:bg-gray-100 active:bg-gray-200 flex-shrink-0">
        <svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
      </button>

      <!-- Label Name & Print Button -->
      <div class="flex-1 flex items-center gap-2 min-w-0 mx-2">
        <span id="mobile-status-dot" class="w-2 h-2 rounded-full bg-gray-400 flex-shrink-0"></span>
        <span id="mobile-label-name" class="text-sm font-medium text-gray-900 truncate">Untitled Label</span>
        <button id="mobile-print-btn" class="p-2 bg-gray-900 text-white rounded-lg active:bg-gray-700 flex-shrink-0">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
          </svg>
        </button>
      </div>

      <!-- GitHub & Affordable Magic Links (far right) -->
      <div class="flex items-center gap-2 flex-shrink-0">
        <a href="https://github.com/transcriptionstream/phomymo" target="_blank" rel="noopener" class="p-1.5 text-gray-600 hover:text-gray-900 active:bg-gray-100 rounded-lg">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
        </a>
        <a href="https://affordablemagic.net" target="_blank" rel="noopener" class="p-1 active:bg-gray-100 rounded-lg">
          <img src="https://affordablemagic.net/affordablemagic-400w.png" alt="Affordable Magic" class="h-10">
        </a>
      </div>
    </div>
  </header>

  <!-- Desktop Top Bar -->
  <header class="desktop-only bg-white border-b border-gray-200 px-2 sm:px-4 py-2 flex-shrink-0">
    <div class="flex items-center justify-between gap-2">
      <div class="flex items-center gap-2 sm:gap-4 flex-shrink-0">
        <div class="flex items-center gap-1 sm:gap-2">
          <h1 class="text-base sm:text-lg font-semibold text-gray-900">Phomymo</h1>
          <button id="info-btn" class="text-gray-400 hover:text-gray-600 transition-colors" title="About this project">
            <svg class="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
          </button>
        </div>

        <!-- Label Size -->
        <div class="flex items-center gap-1 sm:gap-2">
          <select id="label-size" class="text-xs sm:text-sm px-1.5 sm:px-2 py-1 sm:py-1.5 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-gray-400">
            <option value="12x40">12x40mm</option>
            <option value="15x30">15x30mm</option>
            <option value="20x30">20x30mm</option>
            <option value="25x50">25x50mm</option>
            <option value="30x20">30x20mm</option>
            <option value="30x40">30x40mm</option>
            <option value="40x30" selected>40x30mm</option>
            <option value="40x60">40x60mm</option>
            <option value="50x25">50x25mm</option>
            <option value="50x30">50x30mm</option>
            <option value="50x80">50x80mm</option>
            <option value="60x40">60x40mm</option>
            <option disabled>── Round Labels ──</option>
            <option value="20mm Round">20mm Round</option>
            <option value="30mm Round">30mm Round</option>
            <option value="40mm Round">40mm Round</option>
            <option value="50mm Round">50mm Round</option>
            <option value="custom">Custom...</option>
            <option value="multi-label">Multi-Label Roll...</option>
          </select>
          <!-- P12 length adjust buttons (hidden by default, shown for P12 continuous tape) -->
          <div id="label-length-adjust" class="hidden flex items-center gap-1 ml-1">
            <button id="length-minus" class="w-6 h-6 flex items-center justify-center bg-gray-200 hover:bg-gray-300 rounded text-sm font-bold" title="Decrease length by 5mm">−</button>
            <button id="length-plus" class="w-6 h-6 flex items-center justify-center bg-gray-200 hover:bg-gray-300 rounded text-sm font-bold" title="Increase length by 5mm">+</button>
          </div>
          <!-- Custom size inputs (hidden by default) -->
          <div id="custom-size" class="hidden flex items-center gap-1">
            <input type="number" id="custom-width" class="w-12 sm:w-14 px-1.5 sm:px-2 py-1 sm:py-1.5 text-xs sm:text-sm border border-gray-300 rounded-lg" placeholder="W" min="10" max="100">
            <span id="custom-size-x" class="text-gray-400 text-xs">x</span>
            <input type="number" id="custom-height" class="w-12 sm:w-14 px-1.5 sm:px-2 py-1 sm:py-1.5 text-xs sm:text-sm border border-gray-300 rounded-lg" placeholder="H" min="10" max="200">
            <span class="text-xs text-gray-400">mm</span>
            <label class="flex items-center gap-1 ml-1 cursor-pointer">
              <input type="checkbox" id="custom-round" class="w-3.5 h-3.5 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
              <span class="text-xs text-gray-500">Round</span>
            </label>
          </div>
        </div>
      </div>

      <div class="flex items-center gap-1.5 sm:gap-3">
        <!-- Connection -->
        <div class="flex items-center gap-1 sm:gap-2 text-sm">
          <select id="conn-type" class="hidden sm:block px-2 py-1.5 border border-gray-300 rounded-lg bg-white focus:outline-none text-xs sm:text-sm">
            <option value="ble">Bluetooth</option>
            <option value="usb">USB</option>
          </select>
          <button id="connect-btn" class="px-2 sm:px-3 py-1 sm:py-1.5 border border-gray-300 rounded-lg bg-white hover:bg-gray-50 text-xs sm:text-sm font-medium transition-colors">
            Connect
          </button>
          <!-- Printer Info Button (shows when connected) -->
          <button id="printer-info-btn" class="hidden px-2 py-1 border border-gray-200 rounded-lg bg-gray-50 hover:bg-gray-100 text-xs transition-colors flex items-center gap-1.5" title="Printer Info">
            <div id="status-dot" class="w-2 h-2 rounded-full bg-gray-400"></div>
            <span id="printer-info-summary" class="hidden sm:inline text-gray-600">--</span>
            <svg class="w-3 h-3 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
          </button>
          <!-- Status dot when not connected -->
          <div id="status-dot-standalone" class="w-2 h-2 rounded-full bg-gray-400"></div>
        </div>

        <!-- Print Settings & Button -->
        <div class="flex items-center gap-0.5 sm:gap-1">
          <button id="print-settings-btn" class="p-1.5 sm:p-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-l-lg transition-colors" title="Print Settings">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
          </button>
          <button id="print-btn" class="px-3 sm:px-5 py-1.5 sm:py-2 bg-gray-900 hover:bg-gray-800 text-white text-xs sm:text-sm font-medium rounded-r-lg transition-colors">
            Print
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Toolbar (Desktop only) -->
  <div class="desktop-only bg-white border-b border-gray-200 px-2 sm:px-4 py-2 flex-shrink-0">
    <div class="flex items-center gap-1 sm:gap-2 flex-wrap">
      <!-- Add Elements -->
      <button id="add-text" class="toolbar-btn" title="Add Text">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16"/></svg>
        <span class="hidden sm:inline">Text</span>
      </button>
      <button id="add-image" class="toolbar-btn" title="Add Image">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
        <span class="hidden sm:inline">Image</span>
      </button>
      <button id="add-barcode" class="toolbar-btn" title="Add Barcode">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h2M4 12h2m10 0h2M4 8h2m10 0h2m2-4H6a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2z"/></svg>
        <span class="hidden sm:inline">Barcode</span>
      </button>
      <button id="add-qr" class="toolbar-btn" title="Add QR Code">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h2M4 12h2m10 0h2M4 8h2m10 0h2m2-4H6a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2z"/></svg>
        <span class="hidden sm:inline">QR</span>
      </button>
      <!-- Shape dropdown -->
      <div class="relative flex items-center">
        <button id="add-shape-btn" class="toolbar-btn toolbar-btn-menu" title="Add Shape">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v14a1 1 0 01-1 1H5a1 1 0 01-1-1V5z"/></svg>
          <span class="hidden sm:inline">Shape</span>
        </button>
        <div id="shape-dropdown" class="hidden absolute left-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 py-1 min-w-[120px]">
          <button data-shape="rectangle" class="shape-option w-full px-3 py-1.5 text-left text-sm hover:bg-gray-100 flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="4" y="6" width="16" height="12" rx="1" stroke-width="2"/></svg>
            Rectangle
          </button>
          <button data-shape="ellipse" class="shape-option w-full px-3 py-1.5 text-left text-sm hover:bg-gray-100 flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><ellipse cx="12" cy="12" rx="8" ry="6" stroke-width="2"/></svg>
            Ellipse
          </button>
          <button data-shape="triangle" class="shape-option w-full px-3 py-1.5 text-left text-sm hover:bg-gray-100 flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M12 5l8 14H4z"/></svg>
            Triangle
          </button>
          <button data-shape="line" class="shape-option w-full px-3 py-1.5 text-left text-sm hover:bg-gray-100 flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><line x1="4" y1="12" x2="20" y2="12" stroke-width="2"/></svg>
            Line
          </button>
        </div>
      </div>

      <div class="toolbar-divider"></div>

      <!-- Element Actions -->
      <button id="duplicate-btn" class="toolbar-btn" disabled title="Duplicate">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
        <span class="hidden sm:inline">Duplicate</span>
      </button>
      <button id="delete-btn" class="toolbar-btn" disabled title="Delete">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
        <span class="hidden sm:inline">Delete</span>
      </button>

      <div class="toolbar-divider hidden sm:block"></div>

      <!-- Undo/Redo -->
      <button id="undo-btn" class="toolbar-btn" disabled title="Undo (Ctrl+Z)">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"/></svg>
        <span class="hidden sm:inline">Undo</span>
      </button>
      <button id="redo-btn" class="toolbar-btn" disabled title="Redo (Ctrl+Shift+Z)">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 10h-10a8 8 0 00-8 8v2M21 10l-6 6m6-6l-6-6"/></svg>
        <span class="hidden sm:inline">Redo</span>
      </button>

      <div class="toolbar-divider hidden sm:block"></div>

      <!-- Z-Order / Layers -->
      <button id="bring-front" class="toolbar-btn" disabled title="Raise">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <rect x="4" y="8" width="10" height="10" rx="1" stroke-width="2"/>
          <rect x="10" y="4" width="10" height="10" rx="1" stroke-width="2" fill="white"/>
        </svg>
        <span class="hidden sm:inline">Raise</span>
      </button>
      <button id="send-back" class="toolbar-btn" disabled title="Lower">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <rect x="10" y="10" width="10" height="10" rx="1" stroke-width="2"/>
          <rect x="4" y="4" width="10" height="10" rx="1" stroke-width="2" fill="white"/>
        </svg>
        <span class="hidden sm:inline">Lower</span>
      </button>

      <div class="toolbar-divider hidden sm:block"></div>

      <!-- Grouping -->
      <button id="group-btn" class="toolbar-btn" disabled title="Group (Ctrl+G)">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1H5a1 1 0 01-1-1V5zm10 0a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1V5zM4 15a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1H5a1 1 0 01-1-1v-4zm10 0a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"/></svg>
        <span class="hidden sm:inline">Group</span>
      </button>
      <button id="ungroup-btn" class="toolbar-btn" disabled title="Ungroup (Ctrl+Shift+G)">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1H5a1 1 0 01-1-1V5zm0 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1H5a1 1 0 01-1-1v-4zm10-10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1V5zm0 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"/></svg>
        <span class="hidden sm:inline">Ungroup</span>
      </button>

      <div class="toolbar-divider hidden sm:block"></div>

      <!-- Save/Load/Export -->
      <button id="save-btn" class="toolbar-btn" title="Save">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"/></svg>
        <span class="hidden sm:inline">Save</span>
      </button>
      <button id="load-btn" class="toolbar-btn" title="Load">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/></svg>
        <span class="hidden sm:inline">Load</span>
      </button>
      <button id="export-btn" class="toolbar-btn" title="Export">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
        <span class="hidden sm:inline">Export</span>
      </button>

      <div class="toolbar-divider hidden sm:block"></div>

      <!-- Elements list -->
      <div class="relative flex items-center">
        <button id="elements-btn" class="toolbar-btn toolbar-btn-menu" title="Elements List">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"/></svg>
          <span class="hidden sm:inline">Elements</span>
        </button>
        <div id="elements-dropdown" class="hidden absolute left-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 py-1 min-w-[180px] max-h-[300px] overflow-y-auto">
          <div id="elements-list" class="text-sm">
            <div class="px-3 py-2 text-gray-400 text-center">No elements</div>
          </div>
        </div>
      </div>

      <div class="toolbar-divider hidden" id="template-toolbar-divider"></div>

      <!-- Template Manage Data (shows when template fields detected) -->
      <button id="template-toolbar-btn" class="hidden toolbar-btn bg-purple-50 text-purple-700 hover:bg-purple-100 border-purple-200" title="Manage Template Data">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"/></svg>
        <span id="template-toolbar-label" class="hidden sm:inline">Manage Data</span>
      </button>
    </div>
  </div>

  <!-- Multi-Label Zone Toolbar (hidden by default, desktop only) -->
  <div id="zone-toolbar" class="hidden desktop-only bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-blue-200 px-2 sm:px-4 py-2 flex-shrink-0">
    <div class="flex items-center gap-2 sm:gap-4 flex-wrap">
      <!-- Zone Info -->
      <div class="flex items-center gap-2">
        <span class="text-xs font-semibold text-blue-700 uppercase tracking-wide">Multi-Label</span>
        <span id="zone-config-summary" class="text-xs text-blue-600 bg-blue-100 px-2 py-0.5 rounded-full">4 × 10×20mm</span>
      </div>

      <div class="w-px h-5 bg-blue-200"></div>

      <!-- Zone Selector -->
      <div class="flex items-center gap-1">
        <span class="text-xs text-blue-600 font-medium mr-1">Zone:</span>
        <div id="zone-buttons" class="flex gap-1">
          <!-- Zone buttons will be dynamically added here -->
        </div>
      </div>

      <div class="w-px h-5 bg-blue-200"></div>

      <!-- Clone Controls -->
      <div class="flex items-center gap-2">
        <button id="clone-to-all-btn" class="px-2 py-1 text-xs font-medium text-blue-700 bg-blue-100 hover:bg-blue-200 rounded transition-colors">
          Clone to All
        </button>
        <label class="flex items-center gap-1.5 cursor-pointer">
          <input type="checkbox" id="zone-clone-mode" class="w-3.5 h-3.5 rounded border-blue-300 text-blue-600 focus:ring-blue-500" checked>
          <span class="text-xs text-blue-600">Auto-clone</span>
        </label>
      </div>

      <div class="flex-1"></div>

      <!-- Exit Multi-Label -->
      <button id="exit-multi-label-btn" class="px-2 py-1 text-xs font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors flex items-center gap-1">
        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
        Exit Multi-Label
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <main class="flex-1 flex overflow-hidden relative">
    <!-- Canvas Area -->
    <div class="flex-1 flex items-center justify-center p-3 sm:p-6 overflow-auto relative">
      <div id="canvas-container" class="rounded-lg shadow-inner transition-transform origin-center" style="touch-action: none;">
        <canvas id="preview-canvas" class="cursor-crosshair rounded-lg" style="touch-action: none; -webkit-user-select: none; user-select: none; -webkit-touch-callout: none;"></canvas>
      </div>

      <!-- Inline Text Editor Overlay -->
      <textarea id="inline-text-editor" class="hidden fixed resize-none border-2 border-blue-400 rounded outline-none p-1" style="background: rgba(255,255,255,0.95); overflow: hidden; z-index: 100; box-sizing: border-box;"></textarea>

      <!-- Zoom Controls - Centered bottom (moves to top on mobile) -->
      <div id="zoom-controls" class="absolute bottom-3 sm:bottom-6 left-1/2 -translate-x-1/2 flex items-center gap-2 sm:gap-3 bg-white rounded-xl shadow-lg border border-gray-200 px-2 sm:px-4 py-2 sm:py-3 z-40">
        <button id="zoom-out" class="p-1.5 sm:p-2 rounded-lg hover:bg-gray-100 transition-colors" title="Zoom Out">
          <svg class="w-4 h-4 sm:w-5 sm:h-5 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7"/></svg>
        </button>
        <span id="zoom-level" class="text-sm sm:text-base text-gray-700 w-12 sm:w-14 text-center font-semibold">100%</span>
        <button id="zoom-in" class="p-1.5 sm:p-2 rounded-lg hover:bg-gray-100 transition-colors" title="Zoom In">
          <svg class="w-4 h-4 sm:w-5 sm:h-5 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6m3-3H7"/></svg>
        </button>
        <div class="w-px h-5 sm:h-6 bg-gray-200"></div>
        <button id="zoom-reset" class="px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors font-medium" title="Reset Zoom">
          Reset
        </button>
      </div>

      <!-- Mobile Properties Toggle Button (hidden - replaced by bottom sheet) -->
      <button id="props-toggle" class="hidden fixed bottom-20 right-4 z-50 p-3 bg-gray-900 text-white rounded-full shadow-lg hover:bg-gray-800 transition-colors" title="Properties">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/></svg>
      </button>
    </div>

    <!-- Template Panel (shown when template button clicked) -->
    <aside id="template-panel" class="hidden fixed md:relative inset-y-0 right-0 w-72 sm:w-64 bg-purple-50 border-l border-purple-200 flex-shrink-0 flex flex-col z-50 shadow-xl md:shadow-none">
      <!-- Header -->
      <div class="p-4 border-b border-purple-200 flex items-center justify-between">
        <div class="flex items-center gap-2">
          <svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"/></svg>
          <span class="text-sm font-semibold text-purple-900">Template</span>
        </div>
        <button id="template-panel-close" class="text-purple-400 hover:text-purple-600">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
      </div>

      <!-- Content -->
      <div class="flex-1 overflow-y-auto p-4">
        <!-- Fields Section -->
        <div class="mb-4">
          <div class="flex items-center justify-between mb-2">
            <span class="text-xs font-semibold text-purple-700 uppercase tracking-wide">Fields Detected</span>
            <span id="template-field-count" class="text-xs text-purple-600 font-medium bg-purple-100 px-2 py-0.5 rounded-full">0</span>
          </div>
          <div id="template-field-tags" class="flex flex-wrap gap-1.5 text-xs">
            <span class="text-purple-400 italic">None</span>
          </div>
        </div>

        <!-- Data Section -->
        <div class="mb-4">
          <div class="flex items-center justify-between mb-2">
            <span class="text-xs font-semibold text-purple-700 uppercase tracking-wide">Data Records</span>
            <span id="template-data-count" class="text-xs text-purple-600">0</span>
          </div>
          <button id="template-manage-data" class="w-full px-3 py-2 bg-white hover:bg-purple-100 text-purple-700 border border-purple-200 rounded-lg text-sm font-medium">
            Manage Data
          </button>
        </div>
      </div>

      <!-- Actions Footer -->
      <div class="p-4 border-t border-purple-200 flex flex-col gap-2">
        <button id="template-quick-preview" class="w-full px-3 py-2 bg-white hover:bg-purple-100 text-purple-700 border border-purple-200 rounded-lg text-sm font-medium flex items-center justify-center gap-2">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
          Preview Labels
        </button>
        <button id="template-quick-print" class="w-full px-3 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg text-sm font-medium flex items-center justify-center gap-2">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/></svg>
          Print All (<span id="template-print-count">0</span>)
        </button>
      </div>
    </aside>

    <!-- Properties Panel Backdrop (mobile) -->
    <div id="props-backdrop"></div>

    <!-- Properties Panel -->
    <aside id="props-panel" class="fixed md:relative inset-y-0 right-0 w-72 sm:w-64 bg-white border-l border-gray-200 p-4 overflow-y-auto flex-shrink-0 z-50 transform translate-x-full md:translate-x-0 transition-transform duration-300 ease-in-out shadow-xl md:shadow-none">
      <!-- Mobile Close Button -->
      <button id="props-close" class="md:hidden absolute top-3 right-3 p-1 text-gray-400 hover:text-gray-600">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
      </button>
      <h2 class="text-sm font-semibold text-gray-900 mb-4">Properties</h2>

      <!-- No Selection State -->
      <div id="props-empty" class="text-sm text-gray-400 text-center py-8">
        Click an element to select it,<br>or add a new element.
      </div>

      <!-- Element Properties -->
      <div id="props-content" class="hidden">
        <!-- Transform: Position, Size, Rotation, Layer - Compact layout -->
        <div class="space-y-2 mb-3">
          <!-- Position & Size: X, Y, W, H in a single row -->
          <div class="grid grid-cols-4 gap-1.5">
            <div>
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">X</label>
              <input type="number" id="prop-x" class="w-full px-1.5 py-1 text-xs border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400">
            </div>
            <div>
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">Y</label>
              <input type="number" id="prop-y" class="w-full px-1.5 py-1 text-xs border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400">
            </div>
            <div>
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">W</label>
              <input type="number" id="prop-width" class="w-full px-1.5 py-1 text-xs border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400" min="10">
            </div>
            <div>
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">H</label>
              <input type="number" id="prop-height" class="w-full px-1.5 py-1 text-xs border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400" min="10">
            </div>
          </div>
          <!-- Rotation & Layer on same row -->
          <div class="grid grid-cols-2 gap-3">
            <div>
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">Rotation</label>
              <div class="flex items-center gap-1">
                <input type="number" id="prop-rotation" class="w-full px-1.5 py-1 text-xs border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400" min="0" max="360" step="15">
                <span class="text-[10px] text-gray-400">°</span>
              </div>
            </div>
            <div>
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">Layer</label>
              <div class="text-xs text-gray-600 py-1 px-1.5">
                <span id="prop-layer" class="font-medium">1</span><span class="text-gray-400"> / <span id="prop-layer-total">1</span></span>
              </div>
            </div>
          </div>
        </div>

        <hr class="my-3 border-gray-200">

        <!-- Text Properties -->
        <div id="props-text" class="hidden space-y-2">
          <!-- Text Content -->
          <div>
            <div class="flex items-center justify-between mb-1">
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">Text</label>
              <div class="relative">
                <button id="insert-field-text" class="text-[10px] text-purple-600 hover:text-purple-800 font-medium flex items-center gap-0.5" title="Insert template field">
                  <svg class="w-2.5 h-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                  {{Field}}
                </button>
                <div id="field-dropdown-text" class="hidden absolute right-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 min-w-[140px]">
                  <div class="p-2 border-b border-gray-100">
                    <input type="text" id="new-field-text" class="w-full px-2 py-1 text-xs border border-gray-200 rounded" placeholder="New field name...">
                  </div>
                  <div id="field-list-text" class="max-h-32 overflow-y-auto"></div>
                </div>
              </div>
            </div>
            <textarea id="prop-text-content" class="w-full px-2 py-1.5 text-sm border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400 h-16 resize-none" placeholder="Enter text..."></textarea>
          </div>

          <!-- Font & Size on same row -->
          <div class="grid grid-cols-3 gap-1.5">
            <div class="col-span-2">
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">Font</label>
              <select id="prop-font-family" class="w-full px-1.5 py-1 text-xs border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400">
                <optgroup label="Sans-Serif">
                  <option value="Inter, sans-serif">Inter</option>
                  <option value="Roboto, sans-serif">Roboto</option>
                  <option value="Open Sans, sans-serif">Open Sans</option>
                  <option value="Lato, sans-serif">Lato</option>
                  <option value="Montserrat, sans-serif">Montserrat</option>
                  <option value="Oswald, sans-serif">Oswald</option>
                  <option value="Arial, sans-serif">Arial</option>
                  <option value="Helvetica, sans-serif">Helvetica</option>
                </optgroup>
                <optgroup label="Serif">
                  <option value="Playfair Display, serif">Playfair Display</option>
                  <option value="Merriweather, serif">Merriweather</option>
                  <option value="Georgia, serif">Georgia</option>
                  <option value="Times New Roman, serif">Times New Roman</option>
                </optgroup>
                <optgroup label="Monospace">
                  <option value="Roboto Mono, monospace">Roboto Mono</option>
                  <option value="Source Code Pro, monospace">Source Code Pro</option>
                  <option value="Courier New, monospace">Courier New</option>
                </optgroup>
                <optgroup label="Display">
                  <option value="Impact, sans-serif">Impact</option>
                  <option value="Comic Sans MS, cursive">Comic Sans</option>
                </optgroup>
              </select>
            </div>
            <div>
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">Size</label>
              <input type="number" id="prop-font-size" class="w-full px-1.5 py-1 text-xs border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400 text-center" min="6" max="200" value="24">
            </div>
          </div>

          <!-- Style, Color & Background -->
          <div class="grid grid-cols-3 gap-1.5">
            <div>
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">Style</label>
              <div class="flex border border-gray-200 rounded overflow-hidden">
                <button id="style-bold" class="style-btn flex-1 py-1 hover:bg-gray-100 transition-colors font-bold text-xs" title="Bold">B</button>
                <button id="style-italic" class="style-btn flex-1 py-1 hover:bg-gray-100 transition-colors italic text-xs border-l border-gray-200" title="Italic">I</button>
                <button id="style-underline" class="style-btn flex-1 py-1 hover:bg-gray-100 transition-colors underline text-xs border-l border-gray-200" title="Underline">U</button>
              </div>
            </div>
            <div>
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">Color</label>
              <div class="flex border border-gray-200 rounded overflow-hidden">
                <button data-color="black" class="color-btn flex-1 py-1 hover:bg-gray-50" title="Black text">
                  <span class="block w-3 h-3 mx-auto rounded-sm border border-gray-300 bg-black"></span>
                </button>
                <button data-color="white" class="color-btn flex-1 py-1 hover:bg-gray-50 border-l border-gray-200" title="White text">
                  <span class="block w-3 h-3 mx-auto rounded-sm border border-gray-300 bg-white"></span>
                </button>
              </div>
            </div>
            <div>
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">BG</label>
              <div class="flex border border-gray-200 rounded overflow-hidden">
                <button data-bg="transparent" class="bg-btn flex-1 py-1 hover:bg-gray-50" title="Transparent">
                  <span class="block w-3 h-3 mx-auto rounded-sm border border-gray-300" style="background-image: linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%); background-size: 4px 4px; background-position: 0 0, 0 2px, 2px -2px, -2px 0px;"></span>
                </button>
                <button data-bg="white" class="bg-btn flex-1 py-1 hover:bg-gray-50 border-l border-gray-200" title="White">
                  <span class="block w-3 h-3 mx-auto rounded-sm border border-gray-300 bg-white"></span>
                </button>
                <button data-bg="black" class="bg-btn flex-1 py-1 hover:bg-gray-50 border-l border-gray-200" title="Black">
                  <span class="block w-3 h-3 mx-auto rounded-sm border border-gray-300 bg-black"></span>
                </button>
              </div>
            </div>
          </div>

          <!-- H-Align & V-Align on same row -->
          <div class="grid grid-cols-2 gap-2">
            <div>
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">H-Align</label>
              <div class="flex border border-gray-200 rounded overflow-hidden">
                <button data-align="left" class="align-btn flex-1 py-1 hover:bg-gray-50" title="Left">
                  <svg class="w-3 h-3 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h10M4 18h14"/></svg>
                </button>
                <button data-align="center" class="align-btn flex-1 py-1 hover:bg-gray-50 border-l border-gray-200" title="Center">
                  <svg class="w-3 h-3 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M7 12h10M5 18h14"/></svg>
                </button>
                <button data-align="right" class="align-btn flex-1 py-1 hover:bg-gray-50 border-l border-gray-200" title="Right">
                  <svg class="w-3 h-3 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M10 12h10M6 18h14"/></svg>
                </button>
              </div>
            </div>
            <div>
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">V-Align</label>
              <div class="flex border border-gray-200 rounded overflow-hidden">
                <button data-valign="top" class="valign-btn flex-1 py-1 hover:bg-gray-50" title="Top">
                  <svg class="w-3 h-3 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4h16M12 8v12"/></svg>
                </button>
                <button data-valign="middle" class="valign-btn flex-1 py-1 hover:bg-gray-50 border-l border-gray-200" title="Middle">
                  <svg class="w-3 h-3 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 12h16"/></svg>
                </button>
                <button data-valign="bottom" class="valign-btn flex-1 py-1 hover:bg-gray-50 border-l border-gray-200" title="Bottom">
                  <svg class="w-3 h-3 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v12M4 20h16"/></svg>
                </button>
              </div>
            </div>
          </div>

          <!-- Text Options - compact row -->
          <div class="flex flex-wrap gap-x-3 gap-y-1 pt-1">
            <label class="flex items-center gap-1 cursor-pointer text-[11px] text-gray-600">
              <input type="checkbox" id="prop-no-wrap" class="w-3 h-3 rounded border-gray-300">
              No wrap
            </label>
            <label class="flex items-center gap-1 cursor-pointer text-[11px] text-gray-600">
              <input type="checkbox" id="prop-clip-overflow" class="w-3 h-3 rounded border-gray-300">
              Clip
            </label>
            <label class="flex items-center gap-1 cursor-pointer text-[11px] text-gray-600">
              <input type="checkbox" id="prop-auto-scale" class="w-3 h-3 rounded border-gray-300">
              Auto-fit
            </label>
          </div>
        </div>

        <!-- Image Properties -->
        <div id="props-image" class="hidden space-y-2">
          <div>
            <label class="text-[10px] text-gray-400 uppercase tracking-wide">Scale</label>
            <div class="flex items-center gap-1.5">
              <input type="range" id="prop-image-scale" min="10" max="200" value="100" class="flex-1">
              <input type="number" id="prop-image-scale-input" min="10" max="200" value="100" class="w-12 px-1.5 py-1 text-xs border border-gray-200 rounded text-center">
              <span class="text-[10px] text-gray-400">%</span>
            </div>
          </div>
          <div class="flex items-center justify-between">
            <label class="flex items-center gap-1.5 cursor-pointer text-[11px] text-gray-600">
              <input type="checkbox" id="prop-image-lock-ratio" checked class="w-3 h-3 rounded border-gray-300">
              Lock aspect ratio
            </label>
            <div class="flex gap-1">
              <button id="prop-image-reset" class="px-2 py-1 text-[10px] border border-gray-200 rounded hover:bg-gray-50">Reset</button>
              <button id="prop-replace-image" class="px-2 py-1 text-[10px] border border-gray-200 rounded hover:bg-gray-50">Replace</button>
            </div>
          </div>
          <div>
            <label class="text-[10px] text-gray-400 uppercase tracking-wide">Dithering</label>
            <select id="prop-image-dither" class="w-full px-1.5 py-1 text-xs border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400">
              <option value="none">None</option>
              <option value="threshold">Threshold</option>
              <option value="floyd-steinberg" selected>Floyd-Steinberg</option>
            </select>
          </div>
          <div>
            <label class="text-[10px] text-gray-400 uppercase tracking-wide">Brightness</label>
            <div class="flex items-center gap-1.5">
              <input type="range" id="prop-image-brightness" min="-100" max="100" value="0" class="flex-1">
              <input type="number" id="prop-image-brightness-input" min="-100" max="100" value="0" class="w-12 px-1.5 py-1 text-xs border border-gray-200 rounded text-center">
            </div>
          </div>
          <div>
            <label class="text-[10px] text-gray-400 uppercase tracking-wide">Contrast</label>
            <div class="flex items-center gap-1.5">
              <input type="range" id="prop-image-contrast" min="-100" max="100" value="0" class="flex-1">
              <input type="number" id="prop-image-contrast-input" min="-100" max="100" value="0" class="w-12 px-1.5 py-1 text-xs border border-gray-200 rounded text-center">
            </div>
          </div>
          <input type="file" id="prop-image-input" accept="image/*" class="hidden">
        </div>

        <!-- Barcode Properties -->
        <div id="props-barcode" class="hidden space-y-2">
          <div>
            <div class="flex items-center justify-between mb-1">
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">Data</label>
              <div class="relative">
                <button id="insert-field-barcode" class="text-[10px] text-purple-600 hover:text-purple-800 font-medium flex items-center gap-0.5" title="Insert template field">
                  <svg class="w-2.5 h-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                  {{Field}}
                </button>
                <div id="field-dropdown-barcode" class="hidden absolute right-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 min-w-[140px]">
                  <div class="p-2 border-b border-gray-100">
                    <input type="text" id="new-field-barcode" class="w-full px-2 py-1 text-xs border border-gray-200 rounded" placeholder="New field name...">
                  </div>
                  <div id="field-list-barcode" class="max-h-32 overflow-y-auto"></div>
                </div>
              </div>
            </div>
            <input type="text" id="prop-barcode-data" class="w-full px-2 py-1.5 text-sm border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400" placeholder="Enter barcode data">
          </div>
          <div>
            <label class="text-[10px] text-gray-400 uppercase tracking-wide">Format</label>
            <select id="prop-barcode-format" class="w-full px-1.5 py-1 text-xs border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400">
              <option value="CODE128">CODE128</option>
              <option value="EAN13">EAN-13</option>
              <option value="CODE39">CODE39</option>
            </select>
          </div>
          <div class="flex items-center">
            <label class="flex items-center gap-1.5 cursor-pointer text-[11px] text-gray-600">
              <input type="checkbox" id="prop-barcode-showtext" checked class="w-3 h-3 rounded border-gray-300">
              Show text below barcode
            </label>
          </div>
          <div id="barcode-text-options" class="pt-1 border-t border-gray-100 mt-2">
            <div class="flex items-center gap-3">
              <div class="flex items-center gap-1.5">
                <label class="text-[10px] text-gray-400 uppercase tracking-wide">Text Size</label>
                <input type="number" id="prop-barcode-fontsize" value="12" class="w-14 px-1.5 py-1 text-xs border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400">
              </div>
              <label class="flex items-center gap-1.5 cursor-pointer text-[11px] text-gray-600">
                <input type="checkbox" id="prop-barcode-bold" class="w-3 h-3 rounded border-gray-300">
                Bold
              </label>
            </div>
          </div>
        </div>

        <!-- QR Properties -->
        <div id="props-qr" class="hidden space-y-2">
          <div>
            <div class="flex items-center justify-between mb-1">
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">Data</label>
              <div class="relative">
                <button id="insert-field-qr" class="text-[10px] text-purple-600 hover:text-purple-800 font-medium flex items-center gap-0.5" title="Insert template field">
                  <svg class="w-2.5 h-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                  {{Field}}
                </button>
                <div id="field-dropdown-qr" class="hidden absolute right-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 min-w-[140px]">
                  <div class="p-2 border-b border-gray-100">
                    <input type="text" id="new-field-qr" class="w-full px-2 py-1 text-xs border border-gray-200 rounded" placeholder="New field name...">
                  </div>
                  <div id="field-list-qr" class="max-h-32 overflow-y-auto"></div>
                </div>
              </div>
            </div>
            <input type="text" id="prop-qr-data" class="w-full px-2 py-1.5 text-sm border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400" placeholder="Enter URL or text">
          </div>
        </div>

        <!-- Shape Properties -->
        <div id="props-shape" class="hidden space-y-2">
          <!-- Shape Type -->
          <div>
            <label class="text-[10px] text-gray-400 uppercase tracking-wide">Shape</label>
            <select id="prop-shape-type" class="w-full px-1.5 py-1 text-xs border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400">
              <option value="rectangle">Rectangle</option>
              <option value="ellipse">Ellipse</option>
              <option value="triangle">Triangle</option>
              <option value="line">Line</option>
            </select>
          </div>
          <!-- Fill -->
          <div>
            <label class="text-[10px] text-gray-400 uppercase tracking-wide">Fill</label>
            <select id="shape-fill" class="prop-input">
              <option value="white">White (0%)</option>
              <option value="dither-6">6% Gray</option>
              <option value="dither-12">12% Gray</option>
              <option value="dither-25">25% Gray</option>
              <option value="dither-37">37% Gray</option>
              <option value="dither-50">50% Gray</option>
              <option value="dither-62">62% Gray</option>
              <option value="dither-75">75% Gray</option>
              <option value="dither-87">87% Gray</option>
              <option value="dither-94">94% Gray</option>
              <option value="black">Black (100%)</option>
            </select>
          </div>
          <!-- Stroke & Width -->
          <div class="grid grid-cols-2 gap-2">
            <div>
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">Stroke</label>
              <div class="flex border border-gray-200 rounded overflow-hidden">
                <button data-stroke="none" class="stroke-btn flex-1 py-1 hover:bg-gray-50 text-[10px]" title="No stroke">None</button>
                <button data-stroke="black" class="stroke-btn flex-1 py-1 hover:bg-gray-50 border-l border-gray-200" title="Black stroke">
                  <span class="block w-3 h-3 mx-auto rounded-sm border-2 border-black bg-transparent"></span>
                </button>
                <button data-stroke="white" class="stroke-btn flex-1 py-1 hover:bg-gray-50 border-l border-gray-200" title="White stroke">
                  <span class="block w-3 h-3 mx-auto rounded-sm border-2 border-white bg-gray-400"></span>
                </button>
              </div>
            </div>
            <div>
              <label class="text-[10px] text-gray-400 uppercase tracking-wide">Width</label>
              <input type="number" id="prop-stroke-width" class="w-full px-1.5 py-1 text-xs border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400 text-center" min="1" max="20" value="2">
            </div>
          </div>
          <!-- Corner Radius (for rectangles) -->
          <div id="prop-corner-radius-group">
            <label class="text-[10px] text-gray-400 uppercase tracking-wide">Corner Radius</label>
            <input type="number" id="prop-corner-radius" class="w-full px-1.5 py-1 text-xs border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-400 text-center" min="0" max="100" value="0">
          </div>
        </div>

      </div>
    </aside>
  </main>

  <!-- Status Bar -->
  <footer class="bg-white border-t border-gray-200 px-2 sm:px-4 py-1.5 sm:py-2 flex-shrink-0">
    <div class="flex items-center justify-between text-xs text-gray-400">
      <span id="status-message" class="truncate max-w-[150px] sm:max-w-none">Ready</span>
      <div class="flex items-center gap-2 sm:gap-4 flex-shrink-0">
        <span id="print-size" class="hidden sm:inline">40 x 30 mm</span>
        <span class="text-gray-300 hidden sm:inline">|</span>
        <a href="https://github.com/transcriptionstream/phomymo" target="_blank" rel="noopener" class="hover:text-gray-600 transition-colors flex items-center gap-1">
          <svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
          <span class="hidden sm:inline">GitHub</span>
        </a>
        <span class="text-gray-300 hidden md:inline">|</span>
        <a href="https://affordablemagic.net" target="_blank" rel="noopener" class="hidden md:inline-flex items-center gap-1 hover:text-gray-600 transition-colors">
          <img src="https://affordablemagic.net/affordablemagic-400w.png" alt="Affordable Magic" class="h-3">
          An Affordable Magic product
        </a>
      </div>
    </div>
  </footer>

  <!-- Save Dialog -->
  <div id="save-dialog" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-xl p-6 w-80 shadow-xl">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">Save Design</h3>
      <input type="text" id="save-name" class="prop-input mb-4" placeholder="Design name">
      <div class="flex gap-2">
        <button id="save-cancel" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">Cancel</button>
        <button id="save-confirm" class="flex-1 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800">Save</button>
      </div>
    </div>
  </div>

  <!-- Load Dialog -->
  <div id="load-dialog" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-xl p-6 w-96 shadow-xl max-h-[80vh] flex flex-col">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">Load Design</h3>
      <div id="design-list" class="flex-1 overflow-y-auto mb-4 min-h-[100px]">
        <div class="text-sm text-gray-400 text-center py-8">No saved designs</div>
      </div>
      <div class="border-t border-gray-200 pt-4 mb-4">
        <p class="text-xs text-gray-500 mb-2">Or import from file:</p>
        <button id="import-file-btn" class="w-full px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm flex items-center justify-center gap-2">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/></svg>
          Import from File
        </button>
        <input type="file" id="import-file-input" class="hidden" accept=".json,application/json">
      </div>
      <div class="flex gap-2">
        <button id="load-cancel" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Printer Info Popup -->
  <div id="printer-info-popup" class="hidden absolute bg-white rounded-xl shadow-xl border border-gray-200 w-72 z-50" style="top: 50px; right: 200px;">
    <div class="p-4">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-sm font-semibold text-gray-900">Printer Info</h3>
        <button id="printer-info-refresh" class="text-gray-400 hover:text-gray-600 p-1" title="Refresh">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>
        </button>
      </div>

      <!-- Device Info -->
      <div class="space-y-2 text-sm">
        <div class="flex justify-between">
          <span class="text-gray-500">Device</span>
          <span id="pi-device-name" class="font-medium text-gray-900 text-right max-w-[140px] truncate">--</span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-500">Model</span>
          <span id="pi-model" class="font-medium text-gray-900">--</span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-500">Protocol</span>
          <span id="pi-protocol" class="font-medium text-gray-900">--</span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-500">Print Width</span>
          <span id="pi-width" class="font-medium text-gray-900">--</span>
        </div>

        <div class="border-t border-gray-100 my-2"></div>

        <!-- Status from printer queries -->
        <div class="flex justify-between items-center">
          <span class="text-gray-500">Battery</span>
          <span id="pi-battery" class="font-medium text-gray-900 flex items-center gap-1">
            <span id="pi-battery-icon" class="text-gray-400">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7h16a2 2 0 012 2v6a2 2 0 01-2 2H3a2 2 0 01-2-2V9a2 2 0 012-2zm18 3v4"/></svg>
            </span>
            <span id="pi-battery-text">--</span>
          </span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-500">Paper</span>
          <span id="pi-paper" class="font-medium text-gray-900">--</span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-500">Firmware</span>
          <span id="pi-firmware" class="font-medium text-gray-900">--</span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-500">Serial</span>
          <span id="pi-serial" class="font-medium text-gray-900 text-right max-w-[140px] truncate text-xs">--</span>
        </div>
      </div>

      <div class="mt-3 pt-3 border-t border-gray-100">
        <button id="printer-info-disconnect" class="w-full px-3 py-1.5 text-sm text-red-600 hover:bg-red-50 rounded-lg transition-colors">
          Disconnect
        </button>
      </div>
    </div>
  </div>

  <!-- Print Settings Dialog -->
  <div id="print-settings-dialog" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-[60] p-4">
    <div class="bg-white rounded-xl p-5 sm:p-6 w-full max-w-sm sm:max-w-96 max-h-[85vh] overflow-y-auto shadow-xl">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-900">Print Settings</h3>
        <button id="print-settings-close" class="text-gray-400 hover:text-gray-600">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
      </div>

      <div class="space-y-4">
        <!-- Printer Model -->
        <div>
          <div class="prop-label">Printer Model</div>
          <select id="printer-model" class="prop-input">
            <option value="auto">Auto-detect</option>
            <optgroup label="P12 Series">
              <option value="p12">P12 / P12 Pro (12mm tape)</option>
            </optgroup>
            <optgroup label="M02 Series">
              <option value="m02">M02 / M02S / M02X (48mm)</option>
              <option value="m02-pro">M02 Pro (53mm, 300 DPI)</option>
            </optgroup>
            <optgroup label="M03 Series">
              <option value="m03">M03 / T02 (53mm)</option>
            </optgroup>
            <optgroup label="M04 Series">
              <option value="m04s-53">M04S - 53mm paper</option>
              <option value="m04s-80">M04S - 80mm paper</option>
              <option value="m04s-110">M04S - 110mm paper</option>
            </optgroup>
            <optgroup label="M110 Series">
              <option value="m110">M110 / M120 (48mm)</option>
              <option value="m110s">M110S (48mm)</option>
            </optgroup>
            <optgroup label="M200 Series">
              <option value="m200">M200 (75mm)</option>
              <option value="m250">M250 (75mm)</option>
              <option value="m220">M220 / M221 (80mm)</option>
              <option value="m260">M260 (72mm)</option>
            </optgroup>
            <optgroup label="D-Series">
              <option value="d-series">D30 / D35 / D50 / Q30 / Q30S</option>
            </optgroup>
          </select>
          <div class="text-xs text-gray-400 mt-1">Override if auto-detect doesn't work</div>
        </div>

        <!-- Density -->
        <div>
          <div class="prop-label">Print Density (Darkness)</div>
          <div class="flex items-center gap-3">
            <input type="range" id="print-density" min="1" max="8" value="6" class="flex-1">
            <span id="print-density-value" class="text-sm font-medium w-6 text-center">6</span>
          </div>
          <div class="flex justify-between text-xs text-gray-400 mt-1">
            <span>Light</span>
            <span>Dark</span>
          </div>
        </div>

        <!-- Copies -->
        <div>
          <div class="prop-label">Copies</div>
          <input type="number" id="print-copies" min="1" max="99" value="1" class="prop-input w-20">
        </div>

        <!-- Feed After Print -->
        <div>
          <div class="prop-label">Feed After Print</div>
          <select id="print-feed" class="prop-input">
            <option value="16">Small (2mm)</option>
            <option value="32" selected>Medium (4mm)</option>
            <option value="48">Large (6mm)</option>
            <option value="80">Extra Large (10mm)</option>
          </select>
        </div>
      </div>

      <div class="mt-6 space-y-2">
        <button id="print-density-test" class="w-full px-4 py-2 border border-blue-300 bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 text-sm">
          🧪 Print Density Test
        </button>
        <div class="flex gap-2">
          <button id="print-settings-reset" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm">Reset</button>
          <button id="print-settings-save" class="flex-1 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 text-sm">Save</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Printer Model Prompt Dialog -->
  <div id="printer-model-prompt" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-xl p-6 w-96 shadow-xl">
      <div class="text-center mb-4">
        <div class="w-12 h-12 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-3">
          <svg class="w-6 h-6 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
        </div>
        <h3 class="text-lg font-semibold text-gray-900">Select Your Printer</h3>
        <p class="text-sm text-gray-500 mt-1">
          We couldn't identify <span id="prompt-device-name" class="font-medium text-gray-700"></span>
        </p>
      </div>

      <div class="space-y-2">
        <div class="text-xs text-gray-400 uppercase tracking-wide mb-1">P12 Series</div>
        <button data-model="p12" class="w-full px-4 py-2 text-left border border-gray-200 rounded-lg hover:bg-gray-50 text-sm">
          P12 / P12 Pro (12mm tape)
        </button>

        <div class="text-xs text-gray-400 uppercase tracking-wide mb-1 mt-3">M02 Series</div>
        <button data-model="m02" class="w-full px-4 py-2 text-left border border-gray-200 rounded-lg hover:bg-gray-50 text-sm">
          M02 / M02S / M02X / M02 Pro (48mm)
        </button>

        <div class="text-xs text-gray-400 uppercase tracking-wide mb-1 mt-3">M03 Series</div>
        <button data-model="m03" class="w-full px-4 py-2 text-left border border-gray-200 rounded-lg hover:bg-gray-50 text-sm">
          M03 / T02 (53mm)
        </button>

        <div class="text-xs text-gray-400 uppercase tracking-wide mb-1 mt-3">M04 Series</div>
        <button data-model="m04s-53" class="w-full px-4 py-2 text-left border border-gray-200 rounded-lg hover:bg-gray-50 text-sm">
          M04S - 53mm paper
        </button>
        <button data-model="m04s-80" class="w-full px-4 py-2 text-left border border-gray-200 rounded-lg hover:bg-gray-50 text-sm">
          M04S - 80mm paper
        </button>
        <button data-model="m04s-110" class="w-full px-4 py-2 text-left border border-gray-200 rounded-lg hover:bg-gray-50 text-sm">
          M04S - 110mm paper
        </button>

        <div class="text-xs text-gray-400 uppercase tracking-wide mb-1 mt-3">M110 Series</div>
        <button data-model="m110" class="w-full px-4 py-2 text-left border border-gray-200 rounded-lg hover:bg-gray-50 text-sm">
          M110 / M120 (48mm)
        </button>
        <button data-model="m110s" class="w-full px-4 py-2 text-left border border-gray-200 rounded-lg hover:bg-gray-50 text-sm">
          M110S (48mm)
        </button>

        <div class="text-xs text-gray-400 uppercase tracking-wide mb-1 mt-3">M200 Series</div>
        <button data-model="m200" class="w-full px-4 py-2 text-left border border-gray-200 rounded-lg hover:bg-gray-50 text-sm">
          M200 (75mm)
        </button>
        <button data-model="m250" class="w-full px-4 py-2 text-left border border-gray-200 rounded-lg hover:bg-gray-50 text-sm">
          M250 (75mm)
        </button>
        <button data-model="m220" class="w-full px-4 py-2 text-left border border-gray-200 rounded-lg hover:bg-gray-50 text-sm">
          M220 / M221 (80mm)
        </button>
        <button data-model="m260" class="w-full px-4 py-2 text-left border border-gray-200 rounded-lg hover:bg-gray-50 text-sm">
          M260 (72mm)
        </button>

        <div class="text-xs text-gray-400 uppercase tracking-wide mb-1 mt-3">D-Series</div>
        <button data-model="d-series" class="w-full px-4 py-2 text-left border border-gray-200 rounded-lg hover:bg-gray-50 text-sm">
          D30 / D35 / D50 / Q30 / Q30S
        </button>
      </div>

      <p class="text-xs text-gray-400 text-center mt-4">
        This choice will be remembered for this device
      </p>
    </div>
  </div>

  <!-- Hidden file input for adding images -->
  <input type="file" id="image-file-input" accept="image/*" class="hidden">

  <!-- Info Dialog -->
  <div id="info-dialog" class="hidden fixed inset-0 bg-gray-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
    <div class="bg-white rounded-2xl shadow-2xl w-[600px] max-w-full overflow-hidden">
      <!-- Header -->
      <div class="bg-gradient-to-r from-blue-600 to-blue-700 px-5 py-4 text-white relative">
        <button id="info-close" class="absolute top-3 right-3 text-white/80 hover:text-white transition-colors">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/></svg>
          </div>
          <div>
            <h3 class="text-lg font-bold">Phomymo</h3>
            <p class="text-blue-100 text-xs">Free Label Designer for Phomemo Printers</p>
          </div>
        </div>
      </div>

      <!-- Content -->
      <div class="p-5 space-y-4">
        <!-- Top row: Features + Privacy -->
        <div class="grid grid-cols-2 gap-3">
          <div class="bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg p-3 border border-green-100">
            <div class="flex items-center gap-2 mb-1">
              <div class="w-6 h-6 bg-green-500 rounded flex items-center justify-center">
                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
              </div>
              <h4 class="font-semibold text-gray-900 text-sm">No Install Required</h4>
            </div>
            <p class="text-xs text-gray-600">Runs in browser. No downloads, no drivers, no account.</p>
          </div>
          <div class="bg-amber-50 rounded-lg p-3 border border-amber-100">
            <div class="flex items-center gap-2 mb-1">
              <div class="w-6 h-6 bg-amber-500 rounded flex items-center justify-center">
                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/></svg>
              </div>
              <h4 class="font-semibold text-gray-900 text-sm">Privacy Focused</h4>
            </div>
            <p class="text-xs text-gray-600">No data collected. Everything stays on your device.</p>
          </div>
        </div>

        <!-- Power Features -->
        <div class="grid grid-cols-2 gap-3">
          <div class="bg-gradient-to-br from-indigo-50 to-violet-50 rounded-lg p-3 border border-indigo-100">
            <div class="flex items-center gap-2 mb-1">
              <div class="w-6 h-6 bg-indigo-500 rounded flex items-center justify-center">
                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
              </div>
              <h4 class="font-semibold text-gray-900 text-sm">Batch Printing</h4>
            </div>
            <p class="text-xs text-gray-600">Templates with {{fields}} + CSV import for bulk labels.</p>
          </div>
          <div class="bg-gradient-to-br from-cyan-50 to-teal-50 rounded-lg p-3 border border-cyan-100">
            <div class="flex items-center gap-2 mb-1">
              <div class="w-6 h-6 bg-cyan-500 rounded flex items-center justify-center">
                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"/></svg>
              </div>
              <h4 class="font-semibold text-gray-900 text-sm">Multi-Label Rolls</h4>
            </div>
            <p class="text-xs text-gray-600">Design multiple labels side-by-side with clone or individual mode.</p>
          </div>
        </div>

        <!-- Supported Printers -->
        <div class="grid grid-cols-3 gap-3">
          <div class="bg-gray-50 rounded-lg p-3 border border-gray-200">
            <span class="text-xs font-medium text-green-600 uppercase tracking-wide">P-Series</span>
            <p class="text-sm text-gray-700">P12, P12 Pro</p>
            <p class="text-xs text-gray-500">12mm tape labels</p>
          </div>
          <div class="bg-gray-50 rounded-lg p-3 border border-gray-200">
            <span class="text-xs font-medium text-blue-600 uppercase tracking-wide">M-Series</span>
            <p class="text-sm text-gray-700">M02, M02S, M02X, M02 Pro, M03, M04S, M110, M120, M200, M220, M221, M250, M260, T02</p>
            <p class="text-xs text-gray-500">48-110mm print width</p>
          </div>
          <div class="bg-gray-50 rounded-lg p-3 border border-gray-200">
            <span class="text-xs font-medium text-purple-600 uppercase tracking-wide">D-Series</span>
            <p class="text-sm text-gray-700">D30, D35, D50, D110, Q30, Q30S</p>
            <p class="text-xs text-gray-500">Compact 12-24mm width</p>
          </div>
        </div>

        <!-- GitHub CTA -->
        <div class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg p-3 border border-gray-200 flex items-center justify-between">
          <div class="flex items-center gap-2">
            <svg class="w-5 h-5 text-yellow-500" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
            <p class="text-sm text-gray-700">Like this tool? <span class="font-medium">Star us on GitHub!</span></p>
          </div>
          <div class="flex gap-2">
            <a href="https://github.com/transcriptionstream/phomymo" target="_blank" rel="noopener" class="inline-flex items-center gap-1.5 px-3 py-1.5 bg-gray-900 text-white text-xs font-medium rounded-lg hover:bg-gray-800 transition-colors">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
              Star
            </a>
            <a href="https://github.com/transcriptionstream/phomymo/issues" target="_blank" rel="noopener" class="inline-flex items-center gap-1.5 px-3 py-1.5 bg-white text-gray-700 text-xs font-medium rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors">
              Report Issue
            </a>
          </div>
        </div>

        <!-- Browser note -->
        <p class="text-xs text-gray-500 text-center">Requires Chrome, Edge, or Chromium-based browser with Web Bluetooth.</p>
      </div>

      <!-- Footer -->
      <div class="bg-gray-50 px-5 py-3 border-t border-gray-100 flex items-center justify-between">
        <p class="text-xs text-gray-400">Not affiliated with Phomemo</p>
        <a href="https://affordablemagic.net" target="_blank" rel="noopener" class="inline-flex items-center gap-2 px-3 py-1.5 bg-white border border-gray-200 rounded-lg hover:border-gray-300 hover:shadow-sm transition-all">
          <img src="https://affordablemagic.net/affordablemagic-400w.png" alt="Affordable Magic" class="h-4">
          <span class="text-xs font-medium text-gray-700">An Affordable Magic Product</span>
        </a>
      </div>
    </div>
  </div>

  <!-- Template Data Dialog -->
  <div id="template-data-dialog" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[70] p-4">
    <div class="bg-white rounded-xl shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col">
      <div class="flex items-center justify-between p-4 border-b border-gray-200">
        <div>
          <h3 class="text-lg font-semibold text-gray-900">Template Data</h3>
          <p class="text-sm text-gray-500">Fields: <span id="template-fields-list" class="font-medium text-purple-600"></span></p>
        </div>
        <button id="template-data-close" class="text-gray-400 hover:text-gray-600">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
      </div>

      <div class="p-4 border-b border-gray-200 flex items-center gap-3">
        <button id="template-import-csv" class="px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium flex items-center gap-1.5">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/></svg>
          Import CSV
        </button>
        <input type="file" id="template-csv-input" class="hidden" accept=".csv,text/csv">
        <button id="template-add-row" class="px-3 py-1.5 bg-purple-100 hover:bg-purple-200 text-purple-700 rounded-lg text-sm font-medium flex items-center gap-1.5">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
          Add Row
        </button>
        <button id="template-clear-all" class="px-3 py-1.5 text-red-600 hover:bg-red-50 rounded-lg text-sm font-medium">
          Clear All
        </button>
        <div class="flex-1"></div>
        <span id="template-record-count" class="text-sm text-gray-500">0 records</span>
      </div>

      <div class="flex-1 overflow-auto p-4">
        <div id="template-data-empty" class="text-center py-12 text-gray-400">
          <svg class="w-12 h-12 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/></svg>
          <p class="mb-2">No data yet</p>
          <p class="text-sm">Import a CSV file or add rows manually</p>
        </div>
        <table class="w-full text-sm">
          <thead>
            <tr id="template-data-header" class="hidden"></tr>
          </thead>
          <tbody id="template-data-body"></tbody>
        </table>
      </div>

      <div class="p-4 border-t border-gray-200 flex items-center justify-between">
        <button id="template-preview-btn" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg font-medium flex items-center gap-2">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
          Preview Labels
        </button>
        <button id="template-print-btn" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium flex items-center gap-2">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/></svg>
          Print All
        </button>
      </div>
    </div>
  </div>

  <!-- Preview Dialog -->
  <div id="preview-dialog" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[70] p-4">
    <div class="bg-white rounded-xl shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col">
      <div class="flex items-center justify-between p-4 border-b border-gray-200">
        <div>
          <h3 class="text-lg font-semibold text-gray-900">Preview Labels</h3>
          <p class="text-sm text-gray-500"><span id="preview-count">0 labels</span> - Click to view full size</p>
        </div>
        <button id="preview-close" class="text-gray-400 hover:text-gray-600">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
      </div>

      <div class="flex-1 overflow-auto p-4">
        <div id="preview-grid" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-4"></div>
      </div>

      <div class="p-4 border-t border-gray-200 flex justify-end">
        <button id="preview-print-selected" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium">
          Print Selected
        </button>
      </div>
    </div>
  </div>

  <!-- Full Preview Dialog -->
  <div id="full-preview-dialog" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[70] p-4">
    <div class="bg-white rounded-xl shadow-xl w-full max-w-lg flex flex-col">
      <div class="flex items-center justify-between p-4 border-b border-gray-200">
        <h3 id="full-preview-title" class="text-lg font-semibold text-gray-900">Label Preview</h3>
        <button id="full-preview-close" class="text-gray-400 hover:text-gray-600">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
      </div>

      <div class="p-4 flex justify-center">
        <canvas id="full-preview-canvas" class="bg-white shadow-lg rounded max-w-full"></canvas>
      </div>

      <div class="p-4 border-t border-gray-200 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <button id="full-preview-prev" class="p-2 hover:bg-gray-100 rounded-lg" title="Previous">
            <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
          </button>
          <button id="full-preview-next" class="p-2 hover:bg-gray-100 rounded-lg" title="Next">
            <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
          </button>
        </div>
        <div class="flex items-center gap-3">
          <label class="flex items-center gap-2 text-sm text-gray-600">
            <input type="checkbox" id="full-preview-include" class="rounded">
            Include in print
          </label>
          <button id="full-preview-print" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium">
            Print This One
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div id="toast-container" class="fixed bottom-20 left-1/2 -translate-x-1/2 z-50 flex flex-col items-center gap-2 pointer-events-none"></div>

  <!-- Keyboard Shortcuts Modal -->
  <div id="shortcuts-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-xl p-6 max-w-md w-full mx-4">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-lg font-semibold">Keyboard Shortcuts</h2>
        <button id="shortcuts-close" class="text-gray-400 hover:text-gray-600">&times;</button>
      </div>
      <div class="grid grid-cols-2 gap-2 text-sm">
        <div class="font-medium text-gray-600">Undo</div>
        <div><kbd class="px-2 py-1 bg-gray-100 rounded">Ctrl+Z</kbd></div>
        <div class="font-medium text-gray-600">Redo</div>
        <div><kbd class="px-2 py-1 bg-gray-100 rounded">Ctrl+Shift+Z</kbd></div>
        <div class="font-medium text-gray-600">Duplicate</div>
        <div><kbd class="px-2 py-1 bg-gray-100 rounded">Ctrl+D</kbd></div>
        <div class="font-medium text-gray-600">Copy</div>
        <div><kbd class="px-2 py-1 bg-gray-100 rounded">Ctrl+C</kbd></div>
        <div class="font-medium text-gray-600">Paste</div>
        <div><kbd class="px-2 py-1 bg-gray-100 rounded">Ctrl+V</kbd></div>
        <div class="font-medium text-gray-600">Delete</div>
        <div><kbd class="px-2 py-1 bg-gray-100 rounded">Delete</kbd> / <kbd class="px-2 py-1 bg-gray-100 rounded">Backspace</kbd></div>
        <div class="font-medium text-gray-600">Nudge 1px</div>
        <div><kbd class="px-2 py-1 bg-gray-100 rounded">Arrow keys</kbd></div>
        <div class="font-medium text-gray-600">Nudge 10px</div>
        <div><kbd class="px-2 py-1 bg-gray-100 rounded">Shift+Arrow</kbd></div>
        <div class="font-medium text-gray-600">Group</div>
        <div><kbd class="px-2 py-1 bg-gray-100 rounded">Ctrl+G</kbd></div>
        <div class="font-medium text-gray-600">Ungroup</div>
        <div><kbd class="px-2 py-1 bg-gray-100 rounded">Ctrl+Shift+G</kbd></div>
        <div class="font-medium text-gray-600">Multi-select</div>
        <div><kbd class="px-2 py-1 bg-gray-100 rounded">Shift+Click</kbd></div>
        <div class="font-medium text-gray-600">Show this help</div>
        <div><kbd class="px-2 py-1 bg-gray-100 rounded">?</kbd></div>
      </div>
      <div class="mt-4 text-xs text-gray-400 text-center">Press Escape to close</div>
    </div>
  </div>

  <!-- Multi-Label Configuration Modal -->
  <div id="multi-label-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-xl p-6 max-w-md w-full mx-4">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-lg font-semibold">Multi-Label Roll</h2>
        <button id="multi-label-close" class="text-gray-400 hover:text-gray-600 text-2xl leading-none">&times;</button>
      </div>

      <p class="text-sm text-gray-500 mb-4">Configure a roll with multiple labels side by side.</p>

      <!-- Preset Selector -->
      <div class="mb-4">
        <label class="text-xs font-semibold text-gray-600 uppercase tracking-wide mb-1 block">Load Preset</label>
        <div class="flex gap-2">
          <select id="multi-label-preset" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-400">
            <option value="">-- Select Preset --</option>
          </select>
          <button id="multi-label-delete-preset" class="px-3 py-2 border border-red-200 text-red-600 rounded-lg text-sm hover:bg-red-50 hidden">Delete</button>
        </div>
      </div>

      <hr class="my-4 border-gray-200">

      <!-- Label Dimensions -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <div>
          <label class="text-xs font-semibold text-gray-600 uppercase tracking-wide mb-1 block">Label Width</label>
          <div class="flex items-center gap-2">
            <input type="number" id="multi-label-width" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-400" value="10" min="5" max="50">
            <span class="text-sm text-gray-400">mm</span>
          </div>
        </div>
        <div>
          <label class="text-xs font-semibold text-gray-600 uppercase tracking-wide mb-1 block">Label Height</label>
          <div class="flex items-center gap-2">
            <input type="number" id="multi-label-height" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-400" value="20" min="5" max="100">
            <span class="text-sm text-gray-400">mm</span>
          </div>
        </div>
      </div>

      <!-- Labels Across and Gap -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <div>
          <label class="text-xs font-semibold text-gray-600 uppercase tracking-wide mb-1 block">Labels Across</label>
          <input type="number" id="multi-label-count" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-400" value="4" min="1" max="8">
        </div>
        <div>
          <label class="text-xs font-semibold text-gray-600 uppercase tracking-wide mb-1 block">Gap Between</label>
          <div class="flex items-center gap-2">
            <input type="number" id="multi-label-gap" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-400" value="2" min="0" max="10" step="0.5">
            <span class="text-sm text-gray-400">mm</span>
          </div>
        </div>
      </div>

      <!-- Clone Mode Toggle -->
      <div class="mb-4 p-3 bg-gray-50 rounded-lg">
        <label class="flex items-center gap-3 cursor-pointer">
          <input type="checkbox" id="multi-label-clone-mode" class="w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
          <div>
            <span class="text-sm font-medium text-gray-700">Clone Mode</span>
            <p class="text-xs text-gray-500">Design one label, automatically copy to all zones</p>
          </div>
        </label>
      </div>

      <!-- Total Width Preview -->
      <div class="mb-4 p-3 bg-blue-50 rounded-lg text-sm">
        <span class="text-blue-700">Total roll width: </span>
        <span id="multi-label-total-width" class="font-semibold text-blue-900">48mm</span>
      </div>

      <!-- Action Buttons -->
      <div class="flex gap-2">
        <button id="multi-label-save-preset" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-50 flex-1">
          Save as Preset
        </button>
        <button id="multi-label-apply" class="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 flex-1">
          Apply
        </button>
      </div>
    </div>
  </div>

  <!-- Print Progress Modal -->
  <div id="print-progress-modal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-xl p-6 w-80">
      <div class="text-center mb-4">
        <div class="text-lg font-semibold" id="progress-title">Printing Labels</div>
        <div class="text-sm text-gray-500" id="progress-subtitle">Preparing...</div>
      </div>
      <div class="w-full bg-gray-200 rounded-full h-3 mb-2 overflow-hidden">
        <div id="progress-bar" class="bg-purple-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
      </div>
      <div class="text-center text-sm text-gray-500" id="progress-detail">0 of 0</div>
      <button id="progress-cancel" class="mt-4 w-full px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm">
        Cancel
      </button>
    </div>
  </div>

  <!-- Mobile Menu Overlay -->
  <div id="mobile-menu-overlay" class="mobile-only mobile-hidden fixed inset-0 z-[60]">
    <!-- Backdrop -->
    <div id="mobile-menu-backdrop" class="absolute inset-0 bg-black/50"></div>

    <!-- Slide-out Menu -->
    <aside id="mobile-menu-panel" class="absolute left-0 top-0 bottom-0 w-72 bg-white shadow-xl transform -translate-x-full">
      <div class="p-4 border-b border-gray-200">
        <div class="flex items-center justify-between">
          <h2 class="text-lg font-semibold text-gray-900">Phomymo</h2>
          <button id="mobile-menu-close" class="p-2 text-gray-400 hover:text-gray-600 active:bg-gray-100 rounded-lg">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>

      <div class="p-4 overflow-y-auto" style="max-height: calc(100vh - 80px);">
        <!-- Label Settings -->
        <div class="mb-6">
          <label class="text-xs font-semibold text-gray-500 uppercase tracking-wide">Label Size</label>
          <div class="flex items-center gap-2 mt-1">
            <select id="mobile-label-size" class="flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm">
              <option value="12x40">12x40mm</option>
              <option value="15x30">15x30mm</option>
              <option value="20x30">20x30mm</option>
              <option value="25x50">25x50mm</option>
              <option value="30x20">30x20mm</option>
              <option value="30x40">30x40mm</option>
              <option value="40x30" selected>40x30mm</option>
              <option value="40x60">40x60mm</option>
              <option value="50x25">50x25mm</option>
              <option value="50x30">50x30mm</option>
              <option value="50x80">50x80mm</option>
              <option value="60x40">60x40mm</option>
              <option disabled>── Round Labels ──</option>
              <option value="20mm Round">20mm Round</option>
              <option value="30mm Round">30mm Round</option>
              <option value="40mm Round">40mm Round</option>
              <option value="50mm Round">50mm Round</option>
              <option value="custom">Custom...</option>
              <option value="multi-label">Multi-Label Roll...</option>
            </select>
            <!-- P12 length adjust buttons (hidden by default, shown for P12 continuous tape) -->
            <div id="mobile-label-length-adjust" class="hidden flex items-center gap-2">
              <button id="mobile-length-minus" class="w-8 h-8 flex items-center justify-center bg-gray-200 hover:bg-gray-300 rounded text-lg font-bold">−</button>
              <button id="mobile-length-plus" class="w-8 h-8 flex items-center justify-center bg-gray-200 hover:bg-gray-300 rounded text-lg font-bold">+</button>
            </div>
          </div>
          <!-- Custom size inputs (hidden by default) -->
          <div id="mobile-custom-size" class="hidden mt-2">
            <div class="flex items-center gap-2">
              <input type="number" id="mobile-custom-width" class="flex-1 px-3 py-2 border border-gray-200 rounded-lg text-base" placeholder="Width" min="10" max="100">
              <span class="text-gray-400 text-base">x</span>
              <input type="number" id="mobile-custom-height" class="flex-1 px-3 py-2 border border-gray-200 rounded-lg text-base" placeholder="Height" min="10" max="200">
              <span class="text-base text-gray-400">mm</span>
            </div>
            <label class="flex items-center gap-2 mt-2 cursor-pointer">
              <input type="checkbox" id="mobile-custom-round" class="w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
              <span class="text-base text-gray-600">Round/Circle label</span>
            </label>
          </div>
        </div>

        <!-- Connection -->
        <div class="mb-6">
          <label class="text-xs font-semibold text-gray-500 uppercase tracking-wide">Connection</label>
          <div class="mt-2 flex gap-2">
            <button id="mobile-connect-btn" class="flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm active:bg-gray-100">
              Connect
            </button>
            <button id="mobile-disconnect-btn" class="hidden px-3 py-2 border border-red-200 bg-red-50 text-red-700 rounded-lg text-sm active:bg-red-100">
              Disconnect
            </button>
            <select id="mobile-conn-type" class="px-3 py-2 border border-gray-200 rounded-lg text-sm">
              <option value="ble">BT</option>
              <option value="usb">USB</option>
            </select>
          </div>
        </div>

        <!-- Templates -->
        <div class="mb-6">
          <div class="flex items-center justify-between">
            <label class="text-xs font-semibold text-gray-500 uppercase tracking-wide">Templates</label>
            <span id="mobile-template-status" class="text-xs text-purple-600 font-medium bg-purple-100 px-2 py-0.5 rounded-full hidden">0 fields</span>
          </div>
          <p class="text-xs text-gray-400 mt-1 mb-2">Use {{Field}} in text for variable data</p>

          <!-- Fields detected -->
          <div id="mobile-template-fields" class="hidden mb-3">
            <div class="text-xs text-gray-500 mb-1">Fields detected:</div>
            <div id="mobile-template-field-tags" class="flex flex-wrap gap-1"></div>
          </div>

          <!-- Data info -->
          <div class="flex items-center justify-between text-sm text-gray-600 mb-2">
            <span>Data records:</span>
            <span id="mobile-template-data-count" class="font-medium">0</span>
          </div>

          <!-- Template actions -->
          <div class="space-y-2">
            <button id="mobile-template-manage" class="w-full px-3 py-2 bg-purple-50 hover:bg-purple-100 active:bg-purple-200 text-purple-700 border border-purple-200 rounded-lg text-sm font-medium flex items-center justify-center gap-2">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2 1 3 3 3h10c2 0 3-1 3-3V7M4 7c0-2 1-3 3-3h10c2 0 3 1 3 3M4 7h16M9 11h6"/></svg>
              Manage Data
            </button>
            <div class="flex gap-2">
              <button id="mobile-template-preview" class="flex-1 px-3 py-2 bg-white hover:bg-gray-50 active:bg-gray-100 text-gray-700 border border-gray-200 rounded-lg text-sm font-medium flex items-center justify-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                Preview
              </button>
              <button id="mobile-template-print" class="flex-1 px-3 py-2 bg-purple-600 hover:bg-purple-700 active:bg-purple-800 text-white rounded-lg text-sm font-medium flex items-center justify-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/></svg>
                Print (<span id="mobile-template-print-count">0</span>)
              </button>
            </div>
          </div>
        </div>

        <!-- Actions -->
        <div class="space-y-1">
          <button id="mobile-save-btn" class="w-full px-3 py-2.5 text-left text-sm hover:bg-gray-100 active:bg-gray-200 rounded-lg flex items-center gap-3">
            <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"/>
            </svg>
            Save Design
          </button>
          <button id="mobile-load-btn" class="w-full px-3 py-2.5 text-left text-sm hover:bg-gray-100 active:bg-gray-200 rounded-lg flex items-center gap-3">
            <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
            </svg>
            Load Design
          </button>

          <hr class="my-3 border-gray-200">

          <button id="mobile-undo-btn" class="w-full px-3 py-2.5 text-left text-sm hover:bg-gray-100 active:bg-gray-200 rounded-lg flex items-center gap-3 disabled:opacity-50" disabled>
            <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"/>
            </svg>
            Undo
          </button>
          <button id="mobile-redo-btn" class="w-full px-3 py-2.5 text-left text-sm hover:bg-gray-100 active:bg-gray-200 rounded-lg flex items-center gap-3 disabled:opacity-50" disabled>
            <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 10h-10a8 8 0 00-8 8v2M21 10l-6 6m6-6l-6-6"/>
            </svg>
            Redo
          </button>

          <hr class="my-3 border-gray-200">

          <button id="mobile-print-settings-btn" class="w-full px-3 py-2.5 text-left text-sm hover:bg-gray-100 active:bg-gray-200 rounded-lg flex items-center gap-3">
            <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
            </svg>
            Print Settings
          </button>
          <button id="mobile-info-btn" class="w-full px-3 py-2.5 text-left text-sm hover:bg-gray-100 active:bg-gray-200 rounded-lg flex items-center gap-3">
            <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            About
          </button>
        </div>
      </div>
    </aside>
  </div>

  <!-- Mobile Fixed Bottom Toolbar -->
  <div id="mobile-toolbar" class="mobile-only mobile-toolbar flex-col">
    <!-- Selection Actions Row (shown when element selected) -->
    <div id="mobile-selection-row" class="hidden mobile-toolbar-row border-b border-gray-100">
      <button id="mobile-edit-btn" class="mobile-tool-btn">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
        </svg>
        <span>Edit</span>
      </button>
      <button id="mobile-duplicate-btn" class="mobile-tool-btn">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
        </svg>
        <span>Copy</span>
      </button>
      <button id="mobile-raise-btn" class="mobile-tool-btn">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"/>
        </svg>
        <span>Forward</span>
      </button>
      <button id="mobile-lower-btn" class="mobile-tool-btn">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
        </svg>
        <span>Back</span>
      </button>
      <button id="mobile-delete-btn" class="mobile-tool-btn danger">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
        </svg>
        <span>Delete</span>
      </button>
    </div>

    <!-- Main Add Tools Row -->
    <div class="mobile-toolbar-row">
      <button id="mobile-add-text" class="mobile-tool-btn">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16"/>
        </svg>
        <span>Text</span>
      </button>
      <button id="mobile-add-image" class="mobile-tool-btn">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
        </svg>
        <span>Image</span>
      </button>
      <div class="mobile-divider"></div>
      <button id="mobile-add-rect" class="mobile-tool-btn">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <rect x="4" y="6" width="16" height="12" rx="1" stroke-width="2"/>
        </svg>
        <span>Rect</span>
      </button>
      <button id="mobile-add-ellipse" class="mobile-tool-btn">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <ellipse cx="12" cy="12" rx="8" ry="6" stroke-width="2"/>
        </svg>
        <span>Circle</span>
      </button>
      <button id="mobile-add-line" class="mobile-tool-btn">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <line x1="4" y1="12" x2="20" y2="12" stroke-width="2"/>
        </svg>
        <span>Line</span>
      </button>
      <div class="mobile-divider"></div>
      <button id="mobile-add-barcode" class="mobile-tool-btn">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-width="2" d="M4 4h2v16H4V4zm4 0h1v16H8V4zm3 0h2v16h-2V4zm4 0h1v16h-1V4zm3 0h2v16h-2V4z"/>
        </svg>
        <span>Barcode</span>
      </button>
      <button id="mobile-add-qr" class="mobile-tool-btn">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h2M4 12h2m10 0h2M4 8h2m10 0h2m2-4H6a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2z"/>
        </svg>
        <span>QR</span>
      </button>
    </div>
  </div>

  <!-- Mobile Properties Panel (slides up when editing) -->
  <div id="mobile-props-panel" class="mobile-only mobile-props-panel flex-col">
    <div class="mobile-props-header">
      <span id="mobile-props-title" class="font-medium text-gray-900">Properties</span>
      <button id="mobile-props-close" class="p-1 -mr-1 rounded hover:bg-gray-100">
        <svg class="w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>
    </div>
    <div id="mobile-props-content" class="mobile-props-content">
      <!-- Dynamic content based on selected element type -->
    </div>
  </div>

  <!-- Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.1/qrcode.min.js"></script>
  <script type="module" src="app.js?v=109"></script>
  <script>
    // Show body once styles are ready
    requestAnimationFrame(() => {
      requestAnimationFrame(() => {
        document.body.classList.add('ready');
      });
    });
  </script>
</body>
</html>
